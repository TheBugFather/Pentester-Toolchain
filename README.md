# Pentest-Automater


## Prereqs
Written in Python 3.10.6 for Kali Linux Debian-based OS

## Installation
- Run the setup.py script to build a virtual environment and install all external packages in the created venv.

> Examples:<br> 
>       &emsp;&emsp;- Windows:  `python setup.py venv`<br>
>       &emsp;&emsp;- Linux:  `python3 setup.py venv`

- Once virtual env is built traverse to the (Scripts-Windows or bin-Linux) directory in the environment folder just created.
- For Windows, in the venv\Scripts directory, execute `activate` or `activate.bat` script to activate the virtual environment.
- For Linux, in the venv/bin directory, execute `source activate` to activate the virtual environment.
- If for some reason issues are experienced with the setup script, the alternative is to manually create an environment, activate it, then run pip install -r packages.txt in project root.
- To exit from the virtual environment when finished, execute `deactivate`.


## Purpose
The general strategy is to execute offensive tools, writing output to report files.
Then the report file data is read and parsed with compiled regex to reactively call
the next logical tool based on the chain of output created from the previous command.

## Supported service ports

### TCP Ports

---
20, 21 - FTP <br>
22 - SSH <br>
23 - Telnet <br>
25, 465, 587, 2525 - SMTP <br>
79 - Finger <br>
80, 443, 8080, 8443 - HTTP/HTTPS <br>
110, 995 - Pop3/Pop3 over TLS <br>
119, 433 - NNTP/NNTPS (Network News Transport Protocol) <br>
143, 993 - IMAP/IMAP over TLS <br>
199 - SNMP Smux <br>
445 - SMB <br>
554 - RTSP <br>
631 - Cups <br>
749 - Kerberos (v5 administration and kpasswwd service) <br>
761 - Kerberos (v4 password changing service) <br>
873 - rsync <br>
1025 - NFS or IIS (Indicates Windows operating system) <br>
1433 - MsSQL <br>
1521 - Oracle database <br>
2100 - Oracle XML DB FTP <br>
3306 - MySQL database <br>
3339 - Oracle web interface <br>
3389 - Remote Desktop Protocol <br>
5037, 5555 - Android Debug Bridge <br>
5800, 5900 - VNC <br>
5985, 5986 - Windows Remote Management <br>
9389 - Active Directory Administrative Center
<br><br>

### UDP Ports

---
67 - DHCP <br>
69 - TFTP <br>
464 - Kerberos (v5 password changing service) <br>
4444 - Kerberos (v5 ticket conversion service) <br>
5353 - mDNS
<br><br>

### TCP/UDP Ports

---
42 - Windows Internet Name Service (WINS) <br>
53 - DNS <br>
88 - Kerberos (v5 ticket service) <br>
111 - Rpcbind <br>
123 - NTP <br>
135 - MSRPC <br>
137 - Netbios Name Service <br>
139 - Netbios Session Service <br>
161, 162, 10161, 10162 - SNMP <br>
389, 636 - Ldap <br>
750 - Kerberos (v4 ticket service) <br>
751 - Kerberos (v4 admin service) <br>
1030, 1032, 1033, 1038 - (Good indicator of Windows domain) <br>
1748, 1754, 1808, 1809 - Oracle intelligent agent <br>
2049 - NFS <br>
3268,3269 - globalcatLdap <br>
4445 - Upnotifyp <br>
4555 - RSIP <br>
5357 - WSDAPI <br>
5722 - DFSR <br>
47001 - Windows Remote Management Service <br>
<br>

## How to use


## Function Layout
-- pentest_automater.py --
> main &nbsp;-&nbsp; Loads the config file, runs ping scan to get hosts if subnet scan specified, 
> and launches the scan process on target hosts based on the available number of cpu's.

-- utils.py --
> CompiledRegex &nbsp;-&nbsp; Class object to store compiled regex patterns.

> ConfigClass &nbsp;-&nbsp; Class to store yaml file configurations that are referenced throughout operations.

> config_input &nbsp;-&nbsp; Prompts user for yaml configuration to use for scan automation.

> error_query &nbsp;-&nbsp; Looks up the errno message to get description.

> file_handler &nbsp;-&nbsp; Read/Write file operation handler for text and yaml file formats.

> print_err &nbsp;-&nbsp; Displays the error message through stderr (standard error).

> system_cmd &nbsp;-&nbsp; Executes shell-escaped system command with the ability to redirect 
> output to a file for generating scan reports.

## Exit Codes
-- pentest_automater.py --
> 0 - Successful execution (__main__)
> 1 - Unexpected exception occurred (__main__)